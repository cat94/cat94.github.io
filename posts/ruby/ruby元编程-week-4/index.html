<!DOCTYPE html>
<html lang="zh-cmn-Hans">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>
Ruby元编程 星期四
</title>

    
  <link href="https://shenjianan-blog.oss-cn-beijing.aliyuncs.com/avatars/totoro3.jpeg?x-oss-process=style/icon" rel="shortcut icon" type="image/x-icon" />



  
  <meta name="author" content="Shen Jianan" />
  <meta name="description" content="类定义 即将走进&amp;quot;Ruby对象模型最深暗的角落&amp;rdquo;&amp;hellip;和Java不同，在Ruby中，定义类实际上就是在运行代码，这种思想催生了1、可以修改类的类宏 2、可以在其他方法前后封装额外代码的环绕别名。当然，因为类不过是增强的模块，所以这些知识也可以应用于模块。
" />



<meta name="generator" content="Hugo 0.68.3" />

<link rel="canonical" href="http://www.shenjianan.top/posts/ruby/ruby%E5%85%83%E7%BC%96%E7%A8%8B-week-4/" />


<meta property="og:title" content="Ruby元编程 星期四" />
<meta property="og:description" content="类定义
即将走进&quot;Ruby对象模型最深暗的角落&rdquo;&hellip;和Java不同，在Ruby中，定义类实际上就是在运行代码，这种思想催生了1、可以修改类的类宏 2、可以在其他方法前后封装额外代码的环绕别名。当然，因为类不过是增强的模块，所以这些知识也可以应用于模块。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://www.shenjianan.top/posts/ruby/ruby%E5%85%83%E7%BC%96%E7%A8%8B-week-4/" />
<meta property="article:published_time" content="2015-10-28T22:14:08+00:00" />
<meta property="article:modified_time" content="2015-10-28T22:14:08+00:00" />



<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Ruby元编程 星期四"/>
<meta name="twitter:description" content="类定义
即将走进&quot;Ruby对象模型最深暗的角落&rdquo;&hellip;和Java不同，在Ruby中，定义类实际上就是在运行代码，这种思想催生了1、可以修改类的类宏 2、可以在其他方法前后封装额外代码的环绕别名。当然，因为类不过是增强的模块，所以这些知识也可以应用于模块。"/>


<link rel="stylesheet" href="/css/github-markdown.css" />
<link rel="stylesheet" href="/css/semantic.min.css" />
<link rel="stylesheet" href="/css/site.css" />





  </head>

  
  <body style="background-image: url(https://shenjianan-blog.oss-cn-beijing.aliyuncs.com/bg/mountains-covered-in-snow-mid.jpg);">
  
    <div class="flip-container">
      <div class="flipper">
        <section class="front">
          
<nav class="ui secondary menu dream-menu">

  <div class="item">
    <i class="large link bullseye icon dream-flip-toggle" title="Flip it!"></i>
  </div>
  <div class="item">
    <i class="large link home icon" title="Home" onclick="window.location.href = 'http:\/\/www.shenjianan.top\/'"></i>
  </div>
  <div class="item">
    <i class="large link icon theme-switch" onclick="themeSwitch()"></i>
  </div>
</nav>

          
<div class="ui centered relaxed grid dream-grid">
  <div class="sixteen wide mobile sixteen wide tablet twelve wide computer column markdown-body dream-single">

    <section class="ui top attached segment" id="dream-save-post-as-img">
      <header style="margin-top: 0 !important;">
        <h2 class="ui header">
          Ruby元编程 星期四
          <div class="sub header">@ Shen Jianan · Wednesday, Oct 28, 2015 · 7 minute read · Update at Oct 28, 2015</div>
        </h2>
      </header>
      <article style="margin-top: 2rem;"><h1 id="类定义">类定义</h1>
<p>即将走进&quot;Ruby对象模型最深暗的角落&rdquo;&hellip;和Java不同，在Ruby中，定义类实际上就是在运行代码，这种思想催生了1、可以修改类的类宏 2、可以在其他方法前后封装额外代码的环绕别名。当然，因为类不过是增强的模块，所以这些知识也可以应用于模块。</p>
<h2 id="当前类">当前类</h2>
<p>方法所属判断是依靠定义方法的所在self判断的，所以对于父类定义的方法，即使在子类中运行使得m2定义语句得到运行，m2依然属于父类。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">C</span>
  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">m1</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">m2</span>

    <span style="color:#66d9ef">end</span>
  <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>

p C<span style="color:#f92672">.</span>instance_methods(<span style="color:#66d9ef">false</span>)	<span style="color:#75715e"># =&gt; [:m1]</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">D</span><span style="color:#f92672">&lt;</span>C

<span style="color:#66d9ef">end</span>

D<span style="color:#f92672">.</span>new<span style="color:#f92672">.</span>m1

p C<span style="color:#f92672">.</span>instance_methods(<span style="color:#66d9ef">false</span>)	<span style="color:#75715e"># =&gt; [:m1, :m2]</span>

p D<span style="color:#f92672">.</span>instance_methods(<span style="color:#66d9ef">false</span>)	<span style="color:#75715e"># =&gt; []</span>
</code></pre></div><h3 id="class_eval-vs-class关键字">class_eval V.S class关键字</h3>
<p>使用class关键字修改类需要指定类名才可以，那假如想要将类名作为参数来动态修改某个类呢？这时候可以用到Module#class_eval(别名为module_eval)方法。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add_method_to</span>(a_class)
  a_class<span style="color:#f92672">.</span>class_eval <span style="color:#66d9ef">do</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">m</span>
      <span style="color:#e6db74">&#39;Hello!&#39;</span>
    <span style="color:#66d9ef">end</span>
  <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>

add_method_to String
p <span style="color:#e6db74">&#34;abc&#34;</span><span style="color:#f92672">.</span>m			<span style="color:#75715e"># =&gt; &#34;Hello!&#34;</span>
</code></pre></div><p>另外，class是一个作用域门，类外的变量对类里面来说是不可见的。而class_eval则使用扁平作用域，因为它归根结底只是一个方法调用。</p>
<p>可以发现class_eval和instance_eval很相似，class_eval也有带参数版本class_exec。instance_eval的重点在于修改对象中变量的当前self，使其在调用处可见，而class_eval的重点在于修改类。</p>
<h2 id="类的实例变量">类的实例变量</h2>
<p>Ruby的实例变量属于当前self,所以在类中的方法外定义的实例变量属于类这个对象而不是类的实例。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">A</span>
  @var <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">read</span>; @var; <span style="color:#66d9ef">end</span>
  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">write</span>; @var <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>; <span style="color:#66d9ef">end</span>
  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">self</span><span style="color:#f92672">.</span><span style="color:#a6e22e">read</span>; @var; <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">B</span><span style="color:#f92672">&lt;</span>A
  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">self</span><span style="color:#f92672">.</span><span style="color:#a6e22e">read</span>; @var; <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>

obj <span style="color:#f92672">=</span> A<span style="color:#f92672">.</span>new
p obj<span style="color:#f92672">.</span>read      <span style="color:#75715e"># =&gt; nil</span>
p B<span style="color:#f92672">.</span>read		    <span style="color:#75715e"># =&gt; nil</span>
obj<span style="color:#f92672">.</span>write
p obj<span style="color:#f92672">.</span>read      <span style="color:#75715e"># =&gt; 2</span>
p A<span style="color:#f92672">.</span>read        <span style="color:#75715e"># =&gt; 1</span>
</code></pre></div><p>正因为实例变量的归属根据当前self判断，所以子类、实例都不能访问类实例变量，因为这个变量属于“类”这个对象的self。</p>
<p>注意和@@开头的类变量区别开来，它是可以被当前类和子类或实例访问的。正是因为这样，在顶级作用域定义类变量时，所有类都可以访问到它，因为它们都在顶级作用域的覆盖下。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">@@var <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">A</span>
	@@var <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
<span style="color:#66d9ef">end</span>

@@var <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
</code></pre></div><p>为了避免这样的情况，可以的话最好避免使用类变量，转而使用类的实例变量。</p>
<h2 id="单件方法">单件方法</h2>
<p>Ruby支持给单个对象添加方法：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">str <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;this is a string&#34;</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">str</span><span style="color:#f92672">.</span><span style="color:#a6e22e">title?</span>
	self<span style="color:#f92672">.</span>upcase <span style="color:#f92672">==</span> self
<span style="color:#66d9ef">end</span>

str<span style="color:#f92672">.</span>singleton_methods  		<span style="color:#75715e"># =&gt; [:title?]</span>
</code></pre></div><p>和Java中singleton类只允许生成同一个对象的概念有所不同，这里的singleton方法是说这个方法只属于定义它的对象。</p>
<p>实际上，联想到定义类方法时的方法名前的self，类方法其实就是Class对象的单件方法罢了。</p>
<h2 id="类宏">类宏</h2>
<p>Ruby对象没有属性，所以需要写类似Java的getter和setter才能访问或修改属性。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyClass</span>
  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">my_attribute</span><span style="color:#f92672">=</span>(value)
    @my_attribute <span style="color:#f92672">=</span> value
  <span style="color:#66d9ef">end</span>

  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">my_attribue</span>
    @my_attribute
  <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>

obj <span style="color:#f92672">=</span> <span style="color:#66d9ef">MyClass</span><span style="color:#f92672">.</span>new
obj<span style="color:#f92672">.</span>my_attribute <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
obj<span style="color:#f92672">.</span>my_attribute     <span style="color:#75715e"># =&gt; 1</span>
</code></pre></div><p>但是这样写很烦，一点也不酷~ 所以Ruby提供了Module#attr_reader、Module#attr_writer和Module#attr_accessor</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyClass</span>
  <span style="color:#66d9ef">attr_accessor</span> <span style="color:#e6db74">:my_attribute</span>
<span style="color:#66d9ef">end</span>

obj <span style="color:#f92672">=</span> <span style="color:#66d9ef">MyClass</span><span style="color:#f92672">.</span>new
obj<span style="color:#f92672">.</span>my_attribute <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
obj<span style="color:#f92672">.</span>my_attribute     <span style="color:#75715e"># =&gt; 1</span>
</code></pre></div><p>类似attr_accessor这样的方法就叫做类宏，他们看起来像是关键字，实际上只是可以用在类里的方法。</p>
<p>假设需要更新API，将旧的方法声明为deprecated，并且自动转到新方法，那么可以使用像下面这样的代码：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyClass</span>
  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">self</span><span style="color:#f92672">.</span><span style="color:#a6e22e">deprecate</span>(old_method, new_method)
    define_method(old_method) <span style="color:#66d9ef">do</span> <span style="color:#f92672">|*</span>args, <span style="color:#f92672">&amp;</span>block<span style="color:#f92672">|</span>
      warn <span style="color:#e6db74">&#34;Warinig, </span><span style="color:#e6db74">#{</span>old_method<span style="color:#e6db74">}</span><span style="color:#e6db74"> is deprecated, use </span><span style="color:#e6db74">#{</span>new_method<span style="color:#e6db74">}</span><span style="color:#e6db74"> now!&#34;</span>
      send(new_method,<span style="color:#f92672">*</span>args,<span style="color:#f92672">&amp;</span>block)
    <span style="color:#66d9ef">end</span>
  <span style="color:#66d9ef">end</span>

  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">old_m</span>
    p <span style="color:#e6db74">&#34;old&#34;</span>
  <span style="color:#66d9ef">end</span>

  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">new_m</span>
    p <span style="color:#e6db74">&#34;new&#34;</span>
  <span style="color:#66d9ef">end</span>

  deprecate <span style="color:#e6db74">:old_m</span>, <span style="color:#e6db74">:new_m</span>
<span style="color:#66d9ef">end</span>


obj <span style="color:#f92672">=</span> <span style="color:#66d9ef">MyClass</span><span style="color:#f92672">.</span>new
obj<span style="color:#f92672">.</span>old_m
</code></pre></div><h2 id="单件类">单件类</h2>
<p>Ruby查找方法时先进入接收者的类，然后再向上查找。比如一个MyClass类实例obj调用方法，就会进入obj的类MyClass来查找方法。但是单件方法肯定不在类里，否则所有对象都有这个方法了。而对象本身又不是一个类，所以也不在obj里。那么这个方法在哪里呢？</p>
<h3 id="什么是单件类">什么是单件类</h3>
<p>当询问对象的类时，Ruby返回的其实不是看到的类，而是对象特有的隐藏类。这个类被称为这个对象的单件类，或者叫元类。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">obj <span style="color:#f92672">=</span> <span style="color:#66d9ef">Object</span><span style="color:#f92672">.</span>new
singleton_class <span style="color:#f92672">=</span> <span style="color:#66d9ef">class</span> <span style="color:#f92672">&lt;&lt;</span> obj
                    self      <span style="color:#75715e"># =&gt; #&lt;Class:#&lt;Object:0x007fcc711e4278&gt;&gt;</span>
<span style="color:#66d9ef">end</span>

p singleton_class
</code></pre></div><p>这样我们就可以看到这个单件类的引用(.class方法会包装隐藏单件类)，现在Ruby也提供.singleton_class方法返回单件类。每个对象都有自己的单件类，单件类也只有一个实例(有实例说明它的实例也有自己的单件类~循环往复……只是这个单件类的单件类的用途还没有被开发过)。对象的单件方法就放在对应的单件类中。</p>
<p>现在需要更新一下在星期一学习的继承模型了：obj所在的类是obj的单件类，单件类的父类才是MyClass,MyClass类对象的父类是Object。
<img src="https://shenjianan-blog.oss-cn-beijing.aliyuncs.com/images/ruby/MetaProgramming/week4/%E5%8D%95%E4%BB%B6%E7%B1%BB%E7%9A%84%E6%96%B9%E6%B3%95%E6%9F%A5%E6%89%BE.jpg?x-oss-process=style/compress" alt="单件类的方法查找"></p>
<h3 id="单件类和继承">单件类和继承</h3>
<p>假设有如下的类关系，我们可以通过观察继承树输出来了解他们的结构关系</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">C</span>
  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">self</span><span style="color:#f92672">.</span><span style="color:#a6e22e">claz_method</span>

  <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">D</span><span style="color:#f92672">&lt;</span>C

<span style="color:#66d9ef">end</span>

obj <span style="color:#f92672">=</span> D<span style="color:#f92672">.</span>new

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">obj</span><span style="color:#f92672">.</span><span style="color:#a6e22e">singleton_mtd</span>

<span style="color:#66d9ef">end</span>


p C<span style="color:#f92672">.</span>singleton_class       <span style="color:#75715e"># =&gt; #&lt;Class:C&gt;</span>
p D<span style="color:#f92672">.</span>singleton_class       <span style="color:#75715e"># =&gt; #&lt;Class:D&gt;</span>
p D<span style="color:#f92672">.</span>singleton_class<span style="color:#f92672">.</span>superclass  <span style="color:#75715e"># =&gt; #&lt;Class:C&gt;</span>
p C<span style="color:#f92672">.</span>singleton_class<span style="color:#f92672">.</span>superclass  <span style="color:#75715e"># =&gt; #&lt;Class:Object&gt;</span>
p <span style="color:#66d9ef">BasicObject</span><span style="color:#f92672">.</span>singleton_class<span style="color:#f92672">.</span>superclass  <span style="color:#75715e"># =&gt; Class   </span>
</code></pre></div><p><img src="https://shenjianan-blog.oss-cn-beijing.aliyuncs.com/images/ruby/MetaProgramming/week4/%E5%8D%95%E4%BB%B6%E7%B1%BB%E7%9A%84%E7%BB%A7%E6%89%BF%E5%85%B3%E7%B3%BB.jpg?x-oss-process=style/compress" alt="单件类的继承关系"></p>
<h3 id="instance_eval和单件类的关系">instance_eval和单件类的关系</h3>
<p>instance_eval方法会把当前类修改为接收者的单件类。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">s1 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;abc&#39;</span>

s1<span style="color:#f92672">.</span>instance_eval <span style="color:#66d9ef">do</span>
	<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">swoosh!</span>; reverse; <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>
</code></pre></div><p>很少会这样用，但这样是可以的。instance_eval的标准含义还是：修改self作用域内容。</p>
<h3 id="类属性">类属性</h3>
<p>如果想给类创建属性的话，可以使用下面这样的形式：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyClass</span>
	<span style="color:#66d9ef">class</span> <span style="color:#f92672">&lt;&lt;</span> self
		<span style="color:#66d9ef">attr_accessor</span> <span style="color:#e6db74">:c</span>
	<span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>
</code></pre></div><p>因为如果在单件类中定义了方法，这些方法实际上就会成为类方法。而属性其实就是一对方法，所以这样就达到了类属性的效果。</p>
<h3 id="类扩展对象扩展">类扩展/对象扩展</h3>
<p>如果想要从一个Module中导入一个方法到类/对象中，可以打开这个类/对象，然后通过include模块来扩展方法。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#66d9ef">module</span> MyModule
	<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">my_method</span>; <span style="color:#e6db74">&#39;hello&#39;</span>; <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyClass</span>
	<span style="color:#66d9ef">class</span> <span style="color:#f92672">&lt;&lt;</span> self
		<span style="color:#66d9ef">include</span> <span style="color:#66d9ef">MyModule</span>
	<span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>

<span style="color:#66d9ef">MyClass</span><span style="color:#f92672">.</span>my_method		<span style="color:#75715e">#完成了类方法的扩展</span>

obj <span style="color:#f92672">=</span> <span style="color:#66d9ef">Object</span><span style="color:#f92672">.</span>new
<span style="color:#66d9ef">class</span> <span style="color:#f92672">&lt;&lt;</span> obj
	<span style="color:#66d9ef">include</span> <span style="color:#66d9ef">MyModule</span>
<span style="color:#66d9ef">end</span>

obj<span style="color:#f92672">.</span>my_method				<span style="color:#75715e">#完成了对象方法的扩展</span>
obj<span style="color:#f92672">.</span>singleton_methods	<span style="color:#75715e"># =&gt; [:my_method]</span>
</code></pre></div><p>除了使用打开类/对象，还可以使用简单的Object#extend方法。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#66d9ef">module</span> MyModule
	<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">my_method</span>; <span style="color:#e6db74">&#39;hello&#39;</span>; <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>

obj <span style="color:#f92672">=</span> <span style="color:#66d9ef">Object</span><span style="color:#f92672">.</span>new
obj<span style="color:#f92672">.</span>extend <span style="color:#66d9ef">MyModule</span>
obj<span style="color:#f92672">.</span>my_method		<span style="color:#75715e"># =&gt; &#39;hello&#39;</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyClass</span>
	<span style="color:#66d9ef">extend</span> <span style="color:#66d9ef">MyModule</span>
<span style="color:#66d9ef">end</span>

<span style="color:#66d9ef">MyClass</span><span style="color:#f92672">.</span>my_method	<span style="color:#75715e"># =&gt; &#39;hello&#39;</span>

</code></pre></div><h2 id="方法包装器">方法包装器</h2>
<p>如果一个不能修改的接口(比如在库中)有很多地方都被使用，而又想要在所有使用这个接口的地方增加新功能，那找到所有使用接口的地方逐条修改就会变成一件痛苦的事情。Ruby为我们提供了方法包装器的技巧来解决这个问题。</p>
<h3 id="方法别名">方法别名</h3>
<p>使用alias可以为Ruby方法起别名，只要不在顶级作用域里面，可以使用Module#alias_method方法，而在顶级作用域里面，只能使用alias关键字。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyClass</span>
	<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">my_method</span>; <span style="color:#e6db74">&#39;my_method()&#39;</span>; <span style="color:#66d9ef">end</span>
	alias_method <span style="color:#e6db74">:m</span>, <span style="color:#e6db74">:my_method</span>
<span style="color:#66d9ef">end</span>

obj <span style="color:#f92672">=</span> <span style="color:#66d9ef">MyClass</span><span style="color:#f92672">.</span>new
obj<span style="color:#f92672">.</span>my_method		<span style="color:#75715e"># =&gt; &#39;my_method()&#39;</span>
obj<span style="color:#f92672">.</span>m				<span style="color:#75715e"># =&gt; &#39;my_method&#39;</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">my_method2</span>
  <span style="color:#e6db74">&#39;hello&#39;</span>
<span style="color:#66d9ef">end</span>

<span style="color:#66d9ef">alias</span> <span style="color:#e6db74">:m2</span> <span style="color:#e6db74">:my_method2</span>

m2					<span style="color:#75715e"># =&gt; &#39;hello&#39;</span>
</code></pre></div><p>如果原方法在设置了别名之后又被修改了，那么别名指向的还是未被修改时的代码。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">String</span>
	alias_method <span style="color:#e6db74">:real_length</span>, <span style="color:#e6db74">:length</span>
	
	<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">length</span>
		real_length <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">5</span> <span style="color:#f92672">?</span> <span style="color:#e6db74">&#39;long&#39;</span> : <span style="color:#e6db74">&#39;short&#39;</span>
	<span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>

<span style="color:#e6db74">&#34;War and Peace&#34;</span><span style="color:#f92672">.</span>length 		<span style="color:#75715e"># =&gt; &#34;long&#34;</span>
<span style="color:#e6db74">&#34;War and Peace&#34;</span><span style="color:#f92672">.</span>real_length 	<span style="color:#75715e"># =&gt; 13</span>
</code></pre></div><h3 id="不同的方法包装器">不同的方法包装器</h3>
<h4 id="环绕别名">环绕别名</h4>
<p>我们可以通过为A方法设置一个别名B，然后重新定义A方法，插入新添加的功能，最后在A中调用B方法(别名了的原A方法，利用了上面说到的“指向未被修改时的代码”的特性)。
但是这种方法有猴子补丁的问题：所有地方的这个方法都被改变了，但是也许我们只需要在某些地方包装这个方法。</p>
<h3 id="细化">细化</h3>
<p>refinements 提供一种方法让类的修改只影响某个作用域，而可以避免猴子补丁那样影响全局的问题。看下面的代码，我添加一个camelize方法到String类中，但它只能被Foo使用。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#66d9ef">module</span> Camelize
  refine String <span style="color:#66d9ef">do</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">camelize</span>
      dup<span style="color:#f92672">.</span>gsub(<span style="color:#e6db74">/_([a-z])/</span>) {$1<span style="color:#f92672">.</span>upcase }
    <span style="color:#66d9ef">end</span>
  <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Foo</span>
  using <span style="color:#66d9ef">Camelize</span>

  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">camelize_string</span>(str)
    str<span style="color:#f92672">.</span>camelize
  <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>

<span style="color:#66d9ef">Foo</span><span style="color:#f92672">.</span>new<span style="color:#f92672">.</span>camelize_string(<span style="color:#e6db74">&#39;blah_blah_blah&#39;</span>)	<span style="color:#75715e"># =&gt; &#34;blahBlahBlah&#34;</span>
<span style="color:#e6db74">&#39;blah_blah_blah&#39;</span><span style="color:#f92672">.</span>camelize	<span style="color:#75715e"># =&gt; NoMethodError</span>
</code></pre></div><p>当Foo中声明了 refinement 时，我们可以看出它可以使用直接camelize了，但在Foo外却无法使用它。</p>
<p>在refine中使用super可以向方法中包装额外的功能。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#66d9ef">module</span> StringRefinement
	refine String <span style="color:#66d9ef">do</span>
		<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">length</span>
			<span style="color:#66d9ef">super</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">5</span> <span style="color:#f92672">?</span> <span style="color:#e6db74">&#39;long&#39;</span> : <span style="color:#e6db74">&#39;short&#39;</span>
		<span style="color:#66d9ef">end</span>
	<span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>

using <span style="color:#66d9ef">StringRefinement</span>

<span style="color:#e6db74">&#34;War and Peace&#34;</span><span style="color:#f92672">.</span>length			<span style="color:#75715e"># =&gt; &#34;long&#34;</span>
</code></pre></div><p>这样可以确保只在需要这个特性的时候才用到，不会在任何地方都曲解String#length的意思导致混乱。</p>
<h3 id="moduleprepend包装">Module#prepend包装</h3>
<p>Module#prepend的作用和include类似，只是它把包含的模块插在祖先链的下方，这样的话寻找方法时会先找到被包含的模块中的方法，同时可以通过super调用该类中的原始方法。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#66d9ef">module</span> ExplicitString
	<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">length</span>
		<span style="color:#66d9ef">super</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">5</span> <span style="color:#f92672">?</span> <span style="color:#e6db74">&#39;long&#39;</span> : <span style="color:#e6db74">&#39;short&#39;</span>
	<span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>

String class_eval <span style="color:#66d9ef">do</span>
	prepend <span style="color:#66d9ef">ExplicitString</span>
<span style="color:#66d9ef">end</span>

<span style="color:#e6db74">&#34;War and Peace&#34;</span><span style="color:#f92672">.</span>length 		<span style="color:#75715e"># =&gt; &#39;long&#39;</span>
</code></pre></div><p>这一种方法最为清晰，既避免了猴子补丁，也不用考虑细化的问题。细化会导致很多问题，原来的方法调用可以做到缓存来静态查找，但是现在refine让方法查找必须动态。更糟糕的是，任何一个块被调用的时候都有可能被refine了，这是很恐怖的。</p></article>
    </section>

    <footer class="ui attached segment dream-tags">
      
        
          <a class="ui label" href="/tags/ruby" title="Ruby">Ruby</a>
        
          <a class="ui label" href="/tags/%E7%AC%94%E8%AE%B0" title="笔记">笔记</a>
        
      
      <div
        class="ui label"
        style="float: right; background: #1b1c1d !important; cursor: pointer;"
        onclick="savePostAsImg()">
        <i class="save icon"></i> Save as image
      </div>
    </footer>

    
      <footer class="ui attached segment">
        <strong>欢迎通过<a href="mailto:shen_jianan@foxmail.com">邮箱</a>(shen_jianan@foxmail.com)探讨问题</strong> <br/><br/><br />本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可。 <br />
      </footer>
    

    

  </div>
  <div class="sixteen wide mobile sixteen wide tablet four wide computer column">
    <article class="dream-header">
  <section class="ui top attached center aligned segment">
    <div class="ui small circular image">
      
        <img src="https://shenjianan-blog.oss-cn-beijing.aliyuncs.com/avatars/totoro3.jpeg?x-oss-process=style/compress">
      
    </div>

    <h1 class="ui medium header">Shen Jianan&#39;s blog<div class="sub header" style="margin-top: 0.5rem;">Freedom as Autonomy</div>
    </h1>

    <div class="ui horizontal list">
      
      <a class="item" href="/posts">
        <i class="archive icon" title="Archives"></i>
      </a>
      
      <a class="item" href="/tags">
        <i class="tags icon" title="All Tags"></i>
      </a>
      <a class="item" href="/categories">
        <i class="th list icon" title="All Categories"></i>
      </a>
    </div>
  </section>

  
  <section class="ui attached center aligned segment dream-tags">
    
      <a class="ui label" href="/tags/hbase" title="hbase">hbase</a>
    
      <a class="ui label" href="/tags/java" title="java">java</a>
    
      <a class="ui label" href="/tags/redis" title="redis">redis</a>
    
      <a class="ui label" href="/tags/ruby" title="ruby">ruby</a>
    
      <a class="ui label" href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F" title="分布式">分布式</a>
    
      <a class="ui label" href="/tags/%E5%9F%BA%E6%95%B0%E7%BB%9F%E8%AE%A1" title="基数统计">基数统计</a>
    
      <a class="ui label" href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0" title="机器学习">机器学习</a>
    
      <a class="ui label" href="/tags/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C" title="神经网络">神经网络</a>
    
      <a class="ui label" href="/tags/%E7%AC%94%E8%AE%B0" title="笔记">笔记</a>
    
      <a class="ui label" href="/tags/%E7%AE%97%E6%B3%95" title="算法">算法</a>
    
      <a class="ui label" href="/tags/%E7%AE%97%E6%B3%95%E5%BC%95%E6%93%8E" title="算法引擎">算法引擎</a>
    
      <a class="ui label" href="/tags/%E8%AE%BA%E6%96%87" title="论文">论文</a>
    
  </section>
  

  
  <section class="ui attached segment dream-categories">
    <div class="ui accordion">
      
        <div class="title">
          <i class="dropdown icon"></i>
          <a href="/categories/java" class="item">java</a>
        </div>
        <div class="content">
          <div class="ui list">
          
            <div class="item">
              <div class="content">
                <a href="http://www.shenjianan.top/posts/java/java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98-%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" class="item">Java并发编程实战 读书笔记</a>
              </div>
            </div>
          
          </div>
        </div>
      
        <div class="title">
          <i class="dropdown icon"></i>
          <a href="/categories/redis" class="item">redis</a>
        </div>
        <div class="content">
          <div class="ui list">
          
            <div class="item">
              <div class="content">
                <a href="http://www.shenjianan.top/posts/redis/redis%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0%E4%BA%8B%E4%BB%B6/" class="item">Redis设计与实现——事件</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="http://www.shenjianan.top/posts/redis/redis%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0aof%E6%8C%81%E4%B9%85%E5%8C%96/" class="item">Redis设计与实现——AOF持久化</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="http://www.shenjianan.top/posts/redis/redis%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0rdb%E6%8C%81%E4%B9%85%E5%8C%96/" class="item">Redis设计与实现——RDB持久化</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="http://www.shenjianan.top/posts/redis/redis%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E5%BA%93%E5%88%97%E8%A1%A8%E4%B8%8E%E7%BB%93%E6%9E%84%E4%BD%93/" class="item">Redis设计与实现——数据库列表与结构体</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="http://www.shenjianan.top/posts/redis/redis%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0sds%E5%93%88%E5%B8%8C%E8%A1%A8/" class="item">Redis设计与实现——SDS哈希表</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="http://www.shenjianan.top/posts/redis/redis%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0sds%E5%AE%9E%E7%8E%B0%E4%B8%8E%E4%BB%A3%E7%A0%81%E8%A7%A3%E8%AF%BB/" class="item">Redis设计与实现——SDS实现与代码解读</a>
              </div>
            </div>
          
          </div>
        </div>
      
        <div class="title">
          <i class="dropdown icon"></i>
          <a href="/categories/ruby" class="item">ruby</a>
        </div>
        <div class="content">
          <div class="ui list">
          
            <div class="item">
              <div class="content">
                <a href="http://www.shenjianan.top/posts/ruby/ruby%E5%85%83%E7%BC%96%E7%A8%8B-week-5/" class="item">Ruby元编程 星期五</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="http://www.shenjianan.top/posts/ruby/ruby%E5%85%83%E7%BC%96%E7%A8%8B-week-4/" class="item">Ruby元编程 星期四</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="http://www.shenjianan.top/posts/ruby/ruby%E5%85%83%E7%BC%96%E7%A8%8B-week-3/" class="item">Ruby元编程 星期三</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="http://www.shenjianan.top/posts/ruby/ruby%E5%85%83%E7%BC%96%E7%A8%8B-week-2/" class="item">Ruby元编程 星期二</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="http://www.shenjianan.top/posts/ruby/ruby%E5%85%83%E7%BC%96%E7%A8%8B-week-1/" class="item">Ruby元编程 星期一</a>
              </div>
            </div>
          
          </div>
        </div>
      
        <div class="title">
          <i class="dropdown icon"></i>
          <a href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F" class="item">分布式</a>
        </div>
        <div class="content">
          <div class="ui list">
          
            <div class="item">
              <div class="content">
                <a href="http://www.shenjianan.top/posts/distributed/raft%E6%A6%82%E8%AE%BA/" class="item">Raft概论</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="http://www.shenjianan.top/posts/distributed/bigtable%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB-%E4%B8%AA%E4%BA%BA%E7%BF%BB%E8%AF%91/" class="item">BigTable论文阅读&amp;个人翻译</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="http://www.shenjianan.top/posts/distributed/hbase%E5%AE%9E%E6%88%98%E9%9A%8F%E7%AC%94%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C/" class="item">《HBase实战》随笔——数据操作</a>
              </div>
            </div>
          
          </div>
        </div>
      
        <div class="title">
          <i class="dropdown icon"></i>
          <a href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0" class="item">机器学习</a>
        </div>
        <div class="content">
          <div class="ui list">
          
            <div class="item">
              <div class="content">
                <a href="http://www.shenjianan.top/posts/machinelearning/%E4%BC%98%E5%8C%96%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E8%A1%A8%E7%8E%B0%E7%9A%84%E5%87%A0%E7%A7%8D%E6%96%B9%E6%B3%95/" class="item">优化神经网络表现的几种方法</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="http://www.shenjianan.top/posts/machinelearning/%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E8%83%8C%E5%90%8E%E7%9A%84%E5%9B%9B%E4%B8%AA%E5%9F%BA%E6%9C%AC%E7%AD%89%E5%BC%8F/" class="item">反向传播背后的四个基本等式</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="http://www.shenjianan.top/posts/machinelearning/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" class="item">神经网络基础知识</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="http://www.shenjianan.top/posts/machinelearning/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-ex6/" class="item">机器学习 ex6</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="http://www.shenjianan.top/posts/machinelearning/%E6%A0%B8%E5%87%BD%E6%95%B0/" class="item">核函数</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="http://www.shenjianan.top/posts/machinelearning/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD%E8%AE%A1%E7%AE%97%E8%BF%87%E7%A8%8B%E7%AC%94%E8%AE%B0/" class="item">神经网络反向传播计算过程笔记</a>
              </div>
            </div>
          
          </div>
        </div>
      
        <div class="title">
          <i class="dropdown icon"></i>
          <a href="/categories/%E7%AE%97%E6%B3%95" class="item">算法</a>
        </div>
        <div class="content">
          <div class="ui list">
          
            <div class="item">
              <div class="content">
                <a href="http://www.shenjianan.top/posts/algorithm/%E5%9F%BA%E6%95%B0%E7%BB%9F%E8%AE%A1/" class="item">基数统计:从Linear Counting到Hyper LogLog</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="http://www.shenjianan.top/posts/algorithm/%E5%86%8D%E6%8E%A2%E6%8E%92%E5%BA%8F/" class="item">再探排序</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="http://www.shenjianan.top/posts/algorithm/%E4%BA%8C%E5%8F%89%E6%A0%91-%E7%BA%A2%E9%BB%91%E6%A0%91%E5%B0%8F%E7%BB%93/" class="item">简单搜索二叉树&amp;红黑树小结</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="http://www.shenjianan.top/posts/algorithm/%E7%BA%BF%E6%80%A7%E6%97%B6%E9%97%B4%E6%8E%92%E5%BA%8F/" class="item">线性时间排序</a>
              </div>
            </div>
          
            <div class="item">
              <div class="content">
                <a href="http://www.shenjianan.top/posts/algorithm/%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E5%B0%8F%E7%BB%93/" class="item">快速排序算法小结</a>
              </div>
            </div>
          
          </div>
        </div>
      
        <div class="title">
          <i class="dropdown icon"></i>
          <a href="/categories/%E7%AE%97%E6%B3%95%E5%BC%95%E6%93%8E" class="item">算法引擎</a>
        </div>
        <div class="content">
          <div class="ui list">
          
            <div class="item">
              <div class="content">
                <a href="http://www.shenjianan.top/posts/algorithmengine/faiss%E5%90%91%E9%87%8F%E5%8F%AC%E5%9B%9E%E5%BC%95%E6%93%8E%E5%A6%82%E4%BD%95%E5%81%9A%E5%88%B0%E5%BF%AB%E9%80%9F%E6%9F%A5%E6%89%BE%E6%9C%80%E8%BF%91%E9%82%BB/" class="item">Faiss向量召回引擎如何做到快速查找最近邻</a>
              </div>
            </div>
          
          </div>
        </div>
      
    </div>
  </section>
  

  <section class="ui attached segment header-socials">
    <nav class="ui secondary menu dream-menu dream-socials">
  
    <div class="item">
      <i class=" mail icon" title="email"></i> 
      <a href="mailto:shen_jianan@foxmail.com">
        shen_jianan@foxmail.com
      </a>
    </div>
  

  

  

  

  

  

  

  
</nav>

  </section>

  <section class="ui bottom attached center aligned segment">
    
      <p>© 2015 - 2020 Shen Jianan的随缘更新</p>
    

    <p>Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a> with theme <a href="https://github.com/g1eny0ung/hugo-theme-dream" target="_blank">Dream</a>.</p>
  </section>
</article>


  </div>
</div>

        </section>
        <section class="back">
          
<nav class="ui secondary menu dream-menu">

  <div class="item">
    <i class="large link bullseye icon dream-flip-toggle" title="Flip it!"></i>
  </div>
  <div class="item">
    <i class="large link home icon" title="Home" onclick="window.location.href = 'http:\/\/www.shenjianan.top\/'"></i>
  </div>
  <div class="item">
    <i class="large link icon theme-switch" onclick="themeSwitch()"></i>
  </div>
</nav>

          <div class="ui centered relaxed grid dream-grid dream-back">
  
    <section class="sixteen wide mobile eight wide tablet four wide computer column dream-column">
      <article>
        <div class="ui top attached segment">
          <h3 class="ui header">About Me</h3>
        </div>
        <div class="ui attached segment markdown-body">
          <h4 id="201802至今emsp杭州嘉云数据-算法引擎">2018.02至今 杭州嘉云数据 算法引擎</h4>
<h4 id="20176-201712emsp菜网络-工智能部-算法引擎">2017.6-2017.12 菜⻦网络-⼈工智能部-算法引擎</h4>
<h4 id="201609-201806emsp南京大学研究生">2016.09-2018.06 南京大学研究生</h4>
<h4 id="201507-201509emsp阿里巴巴-icbu-实习">2015.07-2015.09 阿里巴巴-ICBU-实习</h4>
<h4 id="201209-201606emsp南京大学本科">2012.09-2016.06 南京大学本科</h4>

        </div>
      </article>
    </section>
  

  <section class="sixteen wide mobile eight wide tablet four wide computer column dream-column">
    <article>
      <div class="ui top attached segment">
        <h3 class="ui header">Social Links</h3>
      </div>
      <div class="ui attached segment">
        <nav class="ui secondary menu dream-menu dream-socials">
  
    <div class="item">
      <i class="large mail icon" title="email"></i> 
      <a href="mailto:shen_jianan@foxmail.com">
        shen_jianan@foxmail.com
      </a>
    </div>
  

  

  

  

  

  

  

  
</nav>

      </div>
    </article>
  </section>

  <section class="sixteen wide mobile eight wide tablet four wide computer column dream-column">
    
      <footer class="ui segment">
        <strong>欢迎通过<a href="mailto:shen_jianan@foxmail.com">邮箱</a>(shen_jianan@foxmail.com)探讨问题</strong> <br/><br/><br />本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可。 <br />
      </footer>
    
  </section>

  
  
</div>

        </section>
      </div>
    </div>

    <script src="/js/jquery.min.js"></script>
<script src="/js/semantic.min.js"></script>
<script src="/js/imagesloaded.pkgd.min.js"></script>
<script src="/js/masonry.pkgd.min.js"></script>
<script src="/js/nav.js"></script>
<script src="/js/header.js"></script>
<script src="/js/main.js"></script>
<script src="/js/theme.js"></script>
<script src="/js/html2canvas.min.js"></script>



  </body>
</html>
